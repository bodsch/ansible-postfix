
{% if postfix_tls.append_default_CA is defined and
      postfix_tls.append_default_CA | string | length > 0 %}
tls_append_default_CA                     = {{ postfix_tls.append_default_CA | bool | ternary('yes', 'no') }}
{% endif %}
{% if postfix_tls.daemon_random_bytes is defined and
      postfix_tls.daemon_random_bytes | string | length > 0 %}
tls_daemon_random_bytes                   = {{ postfix_tls.daemon_random_bytes }}
{% endif %}
{% if postfix_tls.dane_digests is defined and
      postfix_tls.dane_digests | count > 0 %}
tls_dane_digests                          = {{ postfix_tls.dane_digests | join(" ") }}
{% endif %}
{#
CRYPTOPRO_TLSEXT_BUG
DONT_INSERT_EMPTY_FRAGMENTS
LEGACY_SERVER_CONNECT
MICROSOFT_BIG_SSLV3_BUFFER
MICROSOFT_SESS_ID_BUG
MSIE_SSLV2_RSA_PADDING
NETSCAPE_CHALLENGE_BUG
NETSCAPE_REUSE_CIPHER_CHANGE_BUG
SSLEAY_080_CLIENT_DH_BUG
SSLREF2_REUSE_CERT_TYPE_BUG
TLS_BLOCK_PADDING_BUG
TLS_D5_BUG
TLS_ROLLBACK_BUG
TLSEXT_PADDING
#}
tls_disable_workarounds                   =
{% if postfix_tls.eecdh_auto_curves is defined and
      postfix_tls.eecdh_auto_curves | count > 0 %}
tls_eecdh_auto_curves                     = {{ postfix_tls.eecdh_auto_curves | join(" ") }}
{% endif %}
{% if postfix_tls.eecdh_strong_curve is defined and
      postfix_tls.eecdh_strong_curve | string | length > 0 %}
tls_eecdh_strong_curve                    = {{ postfix_tls.eecdh_strong_curve }}
{% endif %}
{% if postfix_tls.eecdh_ultra_curve is defined and
      postfix_tls.eecdh_ultra_curve | string | length > 0 %}
tls_eecdh_ultra_curve                     = {{ postfix_tls.eecdh_ultra_curve }}
{% endif %}
{% if postfix_tls.export_cipherlist is defined and
      postfix_tls.export_cipherlist | count > 0 %}
tls_export_cipherlist                     = {{ postfix_tls.export_cipherlist | join(":") }}
{% endif %}
{% if postfix_tls.fast_shutdown_enable is defined and
      postfix_tls.fast_shutdown_enable | string | length > 0 %}
tls_fast_shutdown_enable                  = {{ postfix_tls.fast_shutdown_enable | bool | ternary('yes', 'no') }}
{% endif %}
tls_high_cipherlist                       = aNULL:-aNULL:HIGH:@STRENGTH
tls_legacy_public_key_fingerprints        = no
tls_low_cipherlist                        = aNULL:-aNULL:HIGH:MEDIUM:LOW:+RC4:@STRENGTH
tls_medium_cipherlist                     = aNULL:-aNULL:HIGH:MEDIUM:+RC4:@STRENGTH
tls_null_cipherlist                       = eNULL:!aNULL

{% if postfix_tls.preempt_cipherlist is defined %}
tls_preempt_cipherlist                    = {{ postfix_tls.preempt_cipherlist | bool | ternary('yes', 'no') }}
{% endif %}

tls_random_bytes                          = 32
tls_random_exchange_name                  = ${data_directory}/prng_exch
tls_random_prng_update_period             = 3600s
tls_random_reseed_period                  = 3600s
tls_random_source                         = dev:/dev/urandom

{% if postfix_tls.server_sni_maps is defined and
      postfix_tls.server_sni_maps | length > 0 %}
tls_server_sni_maps                       = {{ postfix_tls.server_sni_maps }}
{% endif %}

tls_session_ticket_cipher                 = aes-256-cbc

{% if postfix_tls.ssl_options is defined and
      postfix_tls.ssl_options | count > 0 %}
tls_ssl_options                           =
    {{ postfix_tls.ssl_options | join("\n") | indent(4) }}
{% endif %}

tls_wildcard_matches_multiple_labels      = yes
tlsmgr_service_name                       = tlsmgr

{#
tls_append_default_CA = no
tls_daemon_random_bytes = 32
tls_dane_digests = sha512 sha256
tls_disable_workarounds =
tls_eecdh_auto_curves = X25519 X448 prime256v1 secp521r1 secp384r1
tls_eecdh_strong_curve = prime256v1
tls_eecdh_ultra_curve = secp384r1
tls_export_cipherlist = aNULL:-aNULL:HIGH:MEDIUM:LOW:EXPORT:+RC4:@STRENGTH
tls_fast_shutdown_enable = yes
tls_high_cipherlist = aNULL:-aNULL:HIGH:@STRENGTH
tls_legacy_public_key_fingerprints = no
tls_low_cipherlist = aNULL:-aNULL:HIGH:MEDIUM:LOW:+RC4:@STRENGTH
tls_medium_cipherlist = aNULL:-aNULL:HIGH:MEDIUM:+RC4:@STRENGTH
tls_null_cipherlist = eNULL:!aNULL
tls_preempt_cipherlist = yes
tls_random_bytes = 32
tls_random_exchange_name = ${data_directory}/prng_exch
tls_random_prng_update_period = 3600s
tls_random_reseed_period = 3600s
tls_random_source = dev:/dev/urandom
tls_server_sni_maps =
tls_session_ticket_cipher = aes-256-cbc
tls_ssl_options =
tls_wildcard_matches_multiple_labels = yes
tlsmgr_service_name = tlsmgr
#}
