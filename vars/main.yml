---

postfix_dependencies: []

postfix_packages: []

# default values
postfix_config_directory: /etc/postfix
postfix_maps_directory: "{{ postfix_config_directory }}/maps.d"
postfix_virtual_directory: "{{ postfix_config_directory }}/virtual"

postfix_cf: "{{ postfix_config_directory }}/main.cf"
postfix_mailname_file: /etc/mailname
postfix_aliases_file: /etc/aliases

postfix_defaults_aliases: []

postfix_defaults_alias:
  maps_file: "hash:{{ postfix_aliases_file }}"
  database_file: "hash:{{ postfix_aliases_file }}"

postfix_defaults_default:
  database_type: "hash"                             # hash
  delivery_slot_cost: ""                            # 5
  delivery_slot_discount: ""                        # 50
  delivery_slot_loan: ""                            # 3
  delivery_status_filter: ""
  destination_concurrency_failed_cohort_limit: ""   # 1
  destination_concurrency_limit: ""                 # 20
  destination_concurrency_negative_feedback: ""     # 1
  destination_concurrency_positive_feedback: ""     # 1
  destination_rate_delay: ""                        # 0s
  destination_recipient_limit: ""                   # 50
  extra_recipient_limit: ""                         # 1000
  filter_nexthop: ""
  minimum_delivery_slots: ""                        # 3
  privs: ""                                         # nobody
  process_limit: ""                                 # 100
  rbl_reply: ""                                     # $rbl_code Service unavailable; $rbl_class [$rbl_what] blocked using $rbl_domain${rbl_reason?; $rbl_reason}
  recipient_limit: ""                               # 20000
  recipient_refill_delay: ""                        # 5s
  recipient_refill_limit: ""                        # 100
  transport: ""                                     # smtp
  transport_rate_delay: ""                          # 0s
  verp_delimiters: ""                               # +=

postfix_defaults_header:
  checks: []
  checks_database_type: regexp

postfix_defaults_inet:
  # 'all' or a list of interfaces
  # http://www.postfix.org/postconf.5.html#inet_interfaces
  interfaces:
    - loopback-only
  # 'all' or a list of valid protocols like 'ipv4'
  protocols:
    - ipv4

postfix_defaults_mailbox:
  command: ""
  command_maps: []
  delivery_lock:
    - fcntl
    - dotlock
  size_limit: 51200000
  transport: ""
  transport_maps: []

postfix_defaults_maillog:
  file: ""
  file_compressor: gzip
  file_prefixes:
    - /var
    - /dev/stdout
  file_rotate_suffix: "%Y%m%d-%H%M%S"

postfix_defaults_message:
  drop_headers:
    - bcc
    - content-length
    - resent-bcc
    - return-path
  reject_characters: []
  size_limit: 10240000
  strip_characters: []

postfix_defaults_postscreen:
  enable: false
  access_list:
    - permit_mynetworks
    # - cidr:/opt/postfix/conf/custom_postscreen_whitelist.cidr
    # - cidr:/opt/postfix/conf/postscreen_access.cidr
    # - tcp:127.0.0.1:10027
  bare_newline_action: ignore
  bare_newline_enable: false
  bare_newline_ttl: 30d
  # renamed to postscreen_denylist_action in Postfix 3.6.
  #  - ignore (default)
  #  - enforce
  #  - drop
  blacklist_action: ignore
  cache_cleanup_interval: 2h
  cache_map: "proxy:btree:$data_directory/postscreen_cache"
  cache_retention_time: 7d
  client_connection_count_limit: $smtpd_client_connection_count_limit
  command_count_limit: 20
  command_filter: ""
  command_time_limit: ${stress?{10}:{300}}s
  # Available as postscreen_blacklist_action in Postfix 2.8 - 3.5.
  denylist_action: ignore
  disable_vrfy_command: ""
  discard_ehlo_keyword_address_maps: ""
  discard_ehlo_keywords: ""  # silent-discard, dsn
  dnsbl_action: "ignore"
  dnsbl_max_ttl: ""  # ${postscreen_dnsbl_ttl?{$postscreen_dnsbl_ttl}:{1}}h
  dnsbl_min_ttl: ""  # 60s
  dnsbl_reply_map: ""
  dnsbl_sites: []
  dnsbl_threshold: 6
  dnsbl_timeout: 10s
  dnsbl_whitelist_threshold: 0
  dnsbl_ttl: 5m
  enforce_tls: ""  # $smtpd_enforce_tls
  expansion_filter: ""  # $smtpd_expansion_filter
  forbidden_commands: ""  # $smtpd_forbidden_commands
  greet_action: ignore
  greet_banner: ""
  greet_ttl: ""       # 1d
  greet_wait: ""      # ${stress?2}${stress:6}s
  helo_required: ""   # $smtpd_helo_required
  non_smtp_command_action: ""   # drop
  non_smtp_command_enable: ""   # false
  non_smtp_command_ttl: ""      # 30d
  pipelining_action: ""         #  enforce
  pipelining_enable: ""         #  false
  pipelining_ttl: ""            #  30d
  post_queue_limit: $default_process_limit
  pre_queue_limit: $default_process_limit
  reject_footer: $smtpd_reject_footer
  reject_footer_maps: $smtpd_reject_footer_maps
  tls_security_level: $smtpd_tls_security_level
  upstream_proxy_protocol: ""
  upstream_proxy_timeout: 5s
  use_tls: $smtpd_use_tls
  watchdog_timeout: 10s
  whitelist_interfaces: static:all

postfix_defaults_proxy:
  interfaces: ""
  read_maps: []
    # defaults
    ## - "$local_recipient_maps"
    ## - "$mydestination"
    ## - "$virtual_alias_maps"
    ## - "$virtual_alias_domains"
    ## - "$virtual_mailbox_maps"
    ## - "$virtual_mailbox_domains"
    ## - "$relay_recipient_maps"
    ## - "$relay_domains"
    ## - "$canonical_maps"
    ## - "$sender_canonical_maps"
    ## - "$recipient_canonical_maps"
    ## - "$relocated_maps"
    ## - "$transport_maps"
    ## - "$mynetworks"
    ## - "$smtpd_sender_login_maps"
    ## - "$sender_bcc_maps"
    ## - "$recipient_bcc_maps"
    ## - "$smtp_generic_maps"
    ## - "$lmtp_generic_maps"
    ## - "$alias_maps"
    ## - "$smtpd_client_restrictions"
    ## - "$smtpd_helo_restrictions"
    ## - "$smtpd_sender_restrictions"
    ## - "$smtpd_relay_restrictions"
    ## - "$smtpd_recipient_restrictions"
    ## - "$address_verify_sender_dependent_default_transport_maps"
    ## - "$address_verify_sender_dependent_relayhost_maps"
    ## - "$address_verify_transport_maps"
    ## - "$fallback_transport_maps"
    ## - "$lmtp_discard_lhlo_keyword_address_maps"
    ## - "$lmtp_pix_workaround_maps"
    ## - "$lmtp_sasl_password_maps"
    ## - "$lmtp_tls_policy_maps"
    ## - "$mailbox_command_maps"
    ## - "$mailbox_transport_maps"
    ## - "$postscreen_discard_ehlo_keyword_address_maps"
    ## - "$rbl_reply_maps"
    ## - "$sender_dependent_default_transport_maps"
    ## - "$sender_dependent_relayhost_maps"
    ## - "$smtp_discard_ehlo_keyword_address_maps"
    ## - "$smtp_pix_workaround_maps"
    ## - "$smtp_sasl_password_maps"
    ## - "$smtp_tls_policy_maps"
    ## - "$smtpd_discard_ehlo_keyword_address_maps"
    ## - "$smtpd_milter_maps"
    ## - "$virtual_gid_maps"
    ## - "$virtual_uid_maps"
    ## - "$postscreen_reject_footer_maps"
    ## - "$smtpd_reject_footer_maps"
    ## - "$tls_server_sni_maps"
    ## - "$default_delivery_status_filter"
    ## - "$lmtp_delivery_status_filter"
    ## - "$lmtp_dns_reply_filter"
    ## - "$lmtp_reply_filter"
    ## - "$local_delivery_status_filter"
    ## - "$pipe_delivery_status_filter"
    ## - "$postscreen_command_filter"
    ## - "$smtp_delivery_status_filter"
    ## - "$smtp_dns_reply_filter"
    ## - "$smtp_reply_filter"
    ## - "$smtpd_command_filter"
    ## - "$smtpd_dns_reply_filter"
    ## - "$virtual_delivery_status_filter"
    ## - "$body_checks"
    ## - "$header_checks"
    ## - "$lmtp_body_checks"
    ## - "$lmtp_header_checks"
    ## - "$lmtp_mime_header_checks"
    ## - "$lmtp_nested_header_checks"
    ## - "$milter_header_checks"
    ## - "$mime_header_checks"
    ## - "$nested_header_checks"
    ## - "$smtp_body_checks"
    ## - "$smtp_header_checks"
    ## - "$smtp_mime_header_checks"
    ## - "$smtp_nested_header_checks"
  write_maps: []
    # defaults
    ## - "$smtp_sasl_auth_cache_name"
    ## - "$lmtp_sasl_auth_cache_name"
    ## - "$address_verify_map"
    ## - "$postscreen_cache_map"
  map_service_name: ""
  write_service_name: ""

postfix_defaults_queue:
  directory: ""                   # /var/spool/postfix
  file_attribute_count_limit: ""  # 100
  minfree: ""                     # 0
  run_delay: ""                   # 300s
  service_name: ""                # qmgr

postfix_defaults_recipient:
  bcc_maps: ""
  canonical_classes: ""         # envelope_recipient
  canonical_maps: []
  delimiter: ""                 # +
  canonical_maps_database_type: "hash"
  canonical_maps_files: []      # hash:{{ postfix_maps_directory }}/recipient_canonical_maps"

postfix_defaults_reject:
  code: ""                      # 554
  tempfail_action: ""           # defer_if_permit

postfix_defaults_relay:
  clientcerts: ""
  delivery_slot_cost: ""                            # $default_delivery_slot_cost
  delivery_slot_discount: ""                        # $default_delivery_slot_discount
  delivery_slot_loan: ""                            # $default_delivery_slot_loan
  destination_concurrency_failed_cohort_limit: ""   # $default_destination_concurrency_failed_cohort_limit
  destination_concurrency_limit: ""                 # $default_destination_concurrency_limit
  destination_concurrency_negative_feedback: ""     # $default_destination_concurrency_negative_feedback
  destination_concurrency_positive_feedback: ""     # $default_destination_concurrency_positive_feedback
  destination_rate_delay: ""                        # $default_destination_rate_delay
  destination_recipient_limit: ""                   # $default_destination_recipient_limit
  domains: ""                                       # ${{$compatibility_level} < {2} ? {$mydestination} : {}}
  domains_reject_code: ""                           # 554
  extra_recipient_limit: ""                         # $default_extra_recipient_limit
  initial_destination_concurrency: ""               # $initial_destination_concurrency
  minimum_delivery_slots: ""                        # $default_minimum_delivery_slots
  recipient_limit: ""                               # $default_recipient_limit
  recipient_maps: ""                                #
  recipient_refill_delay: ""                        # $default_recipient_refill_delay
  recipient_refill_limit: ""                        # $default_recipient_refill_limit
  transport: ""                                     # relay
  transport_rate_delay: ""                          # $default_transport_rate_delay
  #
  use_tls: false
  mxlookup: false
  host: ''                                          # mail.test.com
  port: 587                                         # 587
  domains_file: ''
  recipient_maps_file: ''

postfix_defaults_sender:
  based_routing: false
  bcc_maps: []
  canonical_classes: []
  canonical_maps: []
  dependent_default_transport_maps: []
  dependent_relayhost_maps: []
  #
  canonical_maps_database_type: "hash"
  canonical_maps_file: "hash:{{ postfix_maps_directory }}/sender_canonical_maps"
  dependent_relayhost_maps_file: "" # hash:{{ postfix_maps_directory }}/sender_dependent_relayhost_maps"

postfix_defaults_smtp:
  use_tls: "{{ postfix_relay.use_tls | bool }}"
  generic_maps_file: "" # hash:{{ postfix_maps_directory }}/generic"
  header_checks_file: "" # hash:{{ postfix_maps_directory }}/header_checks"
  generic_maps: []
  generic_maps_database_type: "hash"
  dns_support_level: ""
  dependent_authentication: true
  sasl:
    auth_enable: true
    user: "postmaster@localhost"
    password: ""
    password_maps_file: "hash:{{ postfix_maps_directory }}/sasl_passwd"
    security_options: noanonymous
    tls_security_options: noanonymous
    mechanism_filter: ""
    auth_soft_bounce: false
  tls:
    security_level: encrypt
    note_starttls_offer: true
    wrappermode: true
    ca_file: ""
    cert_file: ""
    key_file: ""
    loglevel: 1
    mandatory_protocols:
      - "!SSLv2"
      - "!SSLv3"
      - "!TLSv1"
      - "!TLSv1.1"
    protocols:
      - "!SSLv2"
      - "!SSLv3"
    policy_maps_file: ""

postfix_defaults_smtpd:
  banner: '$myhostname ESMTP $mail_name'
  use_tls: false
  client_restrictions: []
  helo_restrictions: []
  sender_restrictions: []
  sender_login_maps: []
  recipient_restrictions: []
  relay_restrictions:
    - permit_mynetworks
    - permit_sasl_authenticated
    - defer_unauth_destination
  data_restrictions:
    - reject_unauth_pipelining
    - permit
  tls:
    auth_only: true
    # "/etc/ssl/certs/ssl-cert-snakeoil.pem"
    cert_file: ""
    # "/etc/ssl/private/ssl-cert-snakeoil.key"
    key_file: ""
    # "/etc/ssl/private/ssl-ca-snakeoil.cabundle"
    ca_file: ""
    chain_files: []
    dh1024_param_file: ""
    eecdh_grade: auto
    cipherlist: []
    exclude_ciphers:
      - ECDHE-RSA-RC4-SHA
      - RC4
      - aNULL
      - DES-CBC3-SHA
      - ECDHE-RSA-DES-CBC3-SHA
      - EDH-RSA-DES-CBC3-SHA
    loglevel: 1
    mandatory_ciphers: high
    mandatory_protocols:
      - "!SSLv2"
      - "!SSLv3"
      - "!TLSv1"
      - "!TLSv1.1"
    protocols:
      - "!SSLv2"
      - "!SSLv3"
    received_header: true
    security_level: may
  sasl:
    auth_enable: false
    authenticated_header: true
    exceptions_networks: []
    local_domain: ""
    mechanism_filter: []
    path: "smtpd" # inet:dovecot:10001
    response_limit: 12288
    #  Specify zero or more of the following:
    # noplaintext
    #     Disallow methods that use plaintext passwords.
    # noactive
    #     Disallow methods subject to active (non-dictionary) attack.
    # nodictionary
    #     Disallow methods subject to passive (dictionary) attack.
    # noanonymous
    #     Disallow methods that allow anonymous authentication.
    # forward_secrecy
    #     Only allow methods that support forward secrecy (Dovecot only).
    # mutual_auth
    #     Only allow methods that provide mutual authentication (not available with Cyrus SASL version 1).
    security_options:
      - noanonymous
    # tls_security_options: "$smtpd_sasl_security_options"
    type: "" # dovecot, cyrus
  milters: ""
  proxy_timeout: ""

postfix_defaults_transport:
  maps_files: []
  #   - "hash:{{ postfix_maps_directory }}/transport_maps"
  maps_database_type: "hash"
  transport_maps: []

postfix_defaults_virtual:
  alias_maps_files: []
#    - "hash:{{ postfix_maps_directory }}/virtual"
  aliases: []
  gid_maps: ""            # static:5000
  uid_maps: ""            # static:5000
  mailbox_base: ""        # /var/vmail/
  mailbox_domains: ""     # proxy:mysql:/opt/postfix/conf/sql/mysql_virtual_domains_maps.cf
  mailbox_maps: ""        # proxy:mysql:/opt/postfix/conf/sql/mysql_virtual_mailbox_maps.cf
  minimum_uid: ""         # 104
  transport: ""           # lmtp:inet:dovecot:24

postfix_defaults_virtual_backends:
  mysql: []

postfix_defaults_tls:
  append_default_CA: false
  daemon_random_bytes: 32
  dane_digests:
    - sha512
    - sha256
  disable_workarounds: ""
  eecdh_auto_curves:
    - X25519
    - X448
    - prime256v1
    - secp521r1
    - secp384r1
  eecdh_strong_curve: prime256v1
  eecdh_ultra_curve: secp384r1
  export_cipherlist:
    - aNULL
    - "-aNULL"
    - HIGH
    - MEDIUM
    - LOW
    - EXPORT
    - "+RC4"
    - "@STRENGTH"
  fast_shutdown_enable: yes
  high_cipherlist: aNULL:-aNULL:HIGH:@STRENGTH
  legacy_public_key_fingerprints: no
  low_cipherlist: aNULL:-aNULL:HIGH:MEDIUM:LOW:+RC4:@STRENGTH
  medium_cipherlist: aNULL:-aNULL:HIGH:MEDIUM:+RC4:@STRENGTH
  null_cipherlist: eNULL:!aNULL
  preempt_cipherlist: yes
  random_bytes: 32
  random_exchange_name: ${data_directory}/prng_exch
  random_prng_update_period: 3600s
  random_reseed_period: 3600s
  random_source: dev:/dev/urandom
  server_sni_maps: ""
  session_ticket_cipher: aes-256-cbc
  ssl_options: ""
  wildcard_matches_multiple_labels: yes
  tlsmgr_service_name: tlsmgr


  protocols:
    smtp: []
    lmtp: []
    smtpd: []
  preempt_cipherlist: true
  server_sni_maps: "" # hash:/opt/postfix/conf/sni.map"
  ssl_options: []

#   service   type  private unpriv  chroot  wakeup  maxproc command + args
#                   (yes)   (yes)   (no)    (never) (100)
postfix_defaults_master:
  # smtp      inet  n       -       n       -       -       smtpd
  smtp:
    type: inet
    private: false
    chroot: false
    command: smtpd
    args: []
  # smtp      inet  n       -       n       -       1       postscreen
  smtp_with_postscreen:
    service: smtp
    enabled: false
    type: inet
    private: false
    chroot: false
    maxproc: 1
    command: postscreen
  # smtpd     pass  -       -       n       -       -       smtpd
  smtpd_deactivated:
    service: smtpd
    enabled: false
    type: pass
    chroot: false
    command: smtpd
  # dnsblog   unix  -       -       n       -       0       dnsblog
  dnsblog:
    enabled: false
    type: unix
    chroot: false
    maxproc: 0
    command: dnsblog
  # tlsproxy  unix  -       -       n       -       0       tlsproxy
  tlsproxy:
    enabled: false
    type: unix
    chroot: false
    maxproc: 0
    command: tlsproxy

  # Choose one: enable submission for loopback clients only, or for any client.
  # 127.0.0.1:submission inet n -   n       -       -       smtpd
  "127.0.0.1:submission":
    enabled: false
    type: inet
    private: false
    chroot: false
    command: smtpd

  # submission inet n       -       n       -       -       smtpd
  submission:
    enabled: false
    type: inet
    private: false
    chroot: false
    command: smtpd
    args:
      - -o syslog_name=postfix/submission
      - -o smtpd_tls_security_level=encrypt
      - -o smtpd_sasl_auth_enable=yes
      - -o smtpd_tls_auth_only=yes
      - -o smtpd_reject_unlisted_recipient=no
      - -o smtpd_client_restrictions=$mua_client_restrictions
      - -o smtpd_helo_restrictions=$mua_helo_restrictions
      - -o smtpd_sender_restrictions=$mua_sender_restrictions
      - -o smtpd_recipient_restrictions=
      - -o smtpd_relay_restrictions=permit_sasl_authenticated,reject
      - -o milter_macro_daemon_name=ORIGINATING

  # Choose one: enable smtps for loopback clients only, or for any client.
  # 127.0.0.1:smtps inet n  -       n       -       -       smtpd
  "127.0.0.1:smtps":
    enabled: false
    type: inet
    private: false
    chroot: false
    command: smtpd

  # smtps     inet  n       -       n       -       -       smtpd
  smtps:
    enabled: false
    type: inet
    private: false
    chroot: false
    command: smtpd
    args:
      - -o syslog_name=postfix/smtps
      - -o smtpd_tls_wrappermode=yes
      - -o smtpd_sasl_auth_enable=yes
      - -o smtpd_reject_unlisted_recipient=no
      - -o smtpd_client_restrictions=$mua_client_restrictions
      - -o smtpd_helo_restrictions=$mua_helo_restrictions
      - -o smtpd_sender_restrictions=$mua_sender_restrictions
      - -o smtpd_recipient_restrictions=
      - -o smtpd_relay_restrictions=permit_sasl_authenticated,reject
      - -o milter_macro_daemon_name=ORIGINATING

  # pickup    unix  n       -       n       60      1       pickup
  pickup:
    type: unix
    private: false
    chroot: false
    wakeup: 60
    maxproc: 1
    command: pickup

  # cleanup   unix  n       -       n       -       0       cleanup
  cleanup:
    type: unix
    private: false
    chroot: false
    maxproc: 0
    command: cleanup

  # qmgr      unix  n       -       n       300     1       qmgr
  qmgr:
    type: unix
    private: false
    chroot: false
    wakeup: 300
    maxproc: 1
    command: qmgr

  #qmgr     unix  n       -       n       300     1       oqmgr
  qmgr_with_other_command:
    service: qmgr
    enabled: false
    type: unix
    private: false
    chroot: false
    wakeup: 300
    maxproc: 1
    command: oqmgr

  # tlsmgr    unix  -       -       n       1000?   1       tlsmgr
  tlsmgr:
    type: unix
    chroot: false
    wakeup: 1000?
    maxproc: 1
    command: tlsmgr

  # rewrite   unix  -       -       n       -       -       trivial-rewrite
  rewrite:
    type: unix
    chroot: false
    command: trivial-rewrite

  # bounce    unix  -       -       n       -       0       bounce
  bounce:
    type: unix
    chroot: false
    maxproc: 0
    command: bounce

  # defer     unix  -       -       n       -       0       bounce
  defer:
    type: unix
    chroot: false
    maxproc: 0
    command: bounce

  # trace     unix  -       -       n       -       0       bounce
  trace:
    type: unix
    chroot: false
    maxproc: 0
    command: bounce

  # verify    unix  -       -       n       -       1       verify
  verify:
    type: unix
    chroot: false
    maxproc: 1
    command: verify

  # flush     unix  n       -       n       1000?   0       flush
  flush:
    type: unix
    chroot: false
    wakeup: 1000?
    maxproc: 0
    command: flush

  # proxymap  unix  -       -       n       -       -       proxymap
  proxymap:
    type: unix
    chroot: false
    command: proxymap

  # proxywrite unix -       -       n       -       1       proxymap
  proxywrite:
    type: unix
    chroot: false
    maxproc: 1
    command: proxymap

  # smtp      unix  -       -       n       -       -       smtp
  smtp_with_type_unix:
    service: smtp
    type: unix
    chroot: false
    command: smtp

  # relay     unix  -       -       n       -       -       smtp
  #      -o syslog_name=postfix/$service_name
  # #     -o smtp_helo_timeout=5 -o smtp_connect_timeout=5
  relay:
    type: unix
    chroot: false
    command: smtp
    args:
      - -o syslog_name=postfix/$service_name
      - -o smtp_helo_timeout=5
      - -o smtp_connect_timeout=5

  # showq     unix  n       -       n       -       -       showq
  showq:
    type: unix
    chroot: false
    command: showq

  # error     unix  -       -       n       -       -       error
  error:
    type: unix
    chroot: false
    command: error

  # retry     unix  -       -       n       -       -       error
  retry:
    type: unix
    chroot: false
    command: error

  # discard   unix  -       -       n       -       -       discard
  discard:
    type: unix
    chroot: false
    command: discard

  # local     unix  -       n       n       -       -       local
  local:
    type: unix
    unpriv: false
    chroot: false
    command: local

  # virtual   unix  -       n       n       -       -       virtual
  virtual:
    type: unix
    unpriv: false
    chroot: false
    command: virtual

  # lmtp      unix  -       -       n       -       -       lmtp
  lmtp:
    type: unix
    chroot: false
    command: lmtp

  # anvil     unix  -       -       n       -       1       anvil
  anvil:
    type: unix
    chroot: false
    maxproc: 1
    command: anvil

  # scache    unix  -       -       n       -       1       scache
  scache:
    type: unix
    chroot: false
    maxproc: 1
    command: scache

  # # postlog   unix-dgram n  -       n       -       1       postlogd
  # postlog:
  #   type: unix-dgram
  #   private: false
  #   chroot: false
  #   maxproc: 1
  #   command: postlogd

...
